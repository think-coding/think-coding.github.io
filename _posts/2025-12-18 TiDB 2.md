---
layout: post
title: TiDB 面试高频题核心背诵提纲（按模块分类）
# feature-img: "assets/img/feature-img/ogre-logo.png"
# thumbnail: "assets/img/thumbnails/feature-img/ogre-logo.png"
author: think-coding
categories: Interview
tags: [TiDB, 面试题, 核心背诵提纲, 按模块分类]
---

# TiDB 面试高频题核心背诵提纲（按模块分类）
## 一、基础概念模块（必背，面试开场必问）
### 1.  TiDB 定位与核心特性
- 类型：**开源分布式 NewSQL 数据库**
- 核心特性：MySQL 兼容、水平扩展、强一致性（Raft）、实时 HTAP、高可用

### 2.  三层架构及作用
| 组件         | 核心作用                                  | 关键特点                  |
|--------------|-------------------------------------------|---------------------------|
| TiDB Server  | SQL 解析/优化/执行，兼容 MySQL 协议       | 无状态，可水平扩展        |
| PD           | 元数据管理、选主、Region 调度、发 TSO     | 奇数节点部署，Raft 选主   |
| TiKV         | 分布式存储，数据分片为 Region，Raft 多副本 | 基于 RocksDB，KV 存储模型 |

### 3.  关键名词解释
- **Region**：TiKV 最小数据分片单位，默认 96MB，超阈值自动分裂
- **TiFlash**：列存引擎，与 TiKV 实时同步，承接 OLAP 查询，实现 HTAP
- **Raft 协议**：分布式一致性算法，TiDB 用于 PD 选主 + TiKV 副本同步，核心是**过半选举 + 日志复制**
- **分片键**：TiDB 中即主键，决定 Region 拆分规则，需满足「高频查询前缀 + 分布均匀」

## 二、架构原理模块（核心难点，区分度高）
### 1.  分布式事务实现
- 核心模型：**Percolator 模型 + 2PC 协议**
- 关键机制：Primary/Secondary 锁、PD 发 TSO 保证全局顺序
- 隔离级别：默认 **RR**（MVCC 实现），支持 Serializable

### 2.  读写请求流程
- **读请求**：客户端 → TiDB Server → PD 查 Region 元数据 → TiKV Region Leader 读数据 → 返回
- **写请求**：客户端 → TiDB Server → PD 查 Region 元数据 → TiKV Leader 同步日志到 Follower → **过半确认后提交** → 返回

### 3.  TiKV 多副本机制
- 默认 **3 副本**：1 Leader + 2 Follower，分散在不同节点/AZ
- 强一致性保证：写请求仅 Leader 处理，过半 Follower 确认才提交

### 4.  MVCC 机制
- 实现：基于 PD 下发的 **TSO 时间戳**，每行数据存储多个版本
- 作用：读写不阻塞、实现事务隔离级别、支持历史数据查询

## 三、运维调优模块（高频实操题，体现实战能力）
### 1.  集群部署与运维
- 最小部署：1TiDB + 1PD + 1TiKV（测试用）
- 生产部署：3PD + 3+TiKV + 3+TiDB + 2+TiFlash（跨 AZ 分布）
- 核心工具：**TiUP**（部署/扩容/升级）、BR（备份恢复）、TiDB Lightning（海量数据导入）

### 2.  性能调优 4 大方向
1.  **分片键优化**：选 user_id 等高频查询字段做前缀，避免自增 ID 热点
2.  **索引优化**：减少冗余索引、建联合索引、开启**索引下推**
3.  **参数调优**：调大 TiKV RocksDB `write-buffer-size`、开启并行查询
4.  **硬件优化**：TiKV/PD 用 NVMe SSD，万兆网卡

### 3.  常见问题解决
| 问题类型       | 发现方法                  | 解决方案                                  |
|----------------|---------------------------|-------------------------------------------|
| 写入热点       | TiDB Dashboard 热点分析   | 复合分片键、哈希取模、打散数据            |
| 数据倾斜       | 查看 Region 大小分布      | 哈希分片、拆分超级用户数据、调整分片键    |
| 慢查询         | 慢查询日志/执行计划       | 加索引、SQL 优化、路由到 TiFlash 执行     |

### 4.  高可用与灾备
- 同城多 AZ：3 副本分布在 3 个 AZ，单 AZ 故障不影响服务
- 异地灾备：主集群 + 异地 Learner 副本，或通过 CDC 同步增量数据

## 四、综合对比模块（选型题，体现技术视野）
### 1.  TiDB vs 传统 MySQL
- 核心差异：分布式架构 vs 单体架构、水平扩展 vs 分库分表、HTAP vs 仅 OLTP
- 迁移注意：避免 MySQL 特有功能（如触发器）、注意自增主键全局唯一性

### 2.  TiDB vs CockroachDB
- 核心差异：MySQL 兼容 vs PostgreSQL 兼容、三层架构 vs 对称架构、HTAP vs 仅 OLTP
- 选型：MySQL 存量业务选 TiDB，全球化部署选 CockroachDB

### 3.  社区版 vs 企业版
- 核心区别：**安全合规（信创）、图形化运维、官方技术支持**（企业版独有）
- 选型：非核心业务用社区版，金融/政务核心业务用企业版

## 五、核心选型原则（一句话总结）
- 适合场景：MySQL 分库分表替代、TB/PB 级数据、高并发 OLTP + 实时 OLAP
- 不适合场景：小规模低并发、纯 OLAP、极致低延迟场景

---
